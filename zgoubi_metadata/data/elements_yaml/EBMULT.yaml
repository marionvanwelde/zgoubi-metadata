zgoubi_name: EBMULT

params:
  IL: {type: I, unit: "", default: 0.0, doc: 'Print field and coordinates along trajectories'}
  #Electric poles
  XL_El: {type: E, unit: "centimeter", default: 0.0, doc: 'Length of element'}
  R0_El: {type: E, unit: "centimeter", default: 10.0, doc: 'Radius at pole tip'}
  PHI1: {type: E, unit: "volt", default: 0.0, doc: 'potential at pole tip for dipolar electric component'}
  PHI2: {type: E, unit: "volt", default: 0.0, doc: 'potential at pole tip for quadrupolar electric component'}
  PHI3: {type: E, unit: "volt", default: 0.0, doc: 'potential at pole tip for sextupolar electric component'}
  PHI4: {type: E, unit: "volt", default: 0.0, doc: 'potential at pole tip for octupolar electric component'}
  PHI5: {type: E, unit: "volt", default: 0.0, doc: 'potential at pole tip for decapolar electric component'}
  PHI6: {type: E, unit: "volt", default: 0.0, doc: 'potential at pole tip for dodecapolar electric component'}
  PHI7: {type: E, unit: "volt", default: 0.0, doc: 'potential at pole tip for 14-polar electric component'}
  PHI8: {type: E, unit: "volt", default: 0.0, doc: 'potential at pole tip for 16-polar electric component'}
  PHI9: {type: E, unit: "volt", default: 0.0, doc: 'potential at pole tip for 18-polar electric component'}
  PHI10: {type: E, unit: "volt", default: 0.0, doc: 'potential at pole tip for 20-polar electric component'}
  X_E_El: {type: E, unit: "centimeter", default: 0.0, doc: 'Entrance face integration zone for the fringe field'}
  LAM_E_El: {type: E, unit: "centimeter", default: 0.0, doc: 'Entrance face dipole fringe field extent'}
  E2_El: {type: E, unit: "", default: 1.0, doc: 'Quadrupole entrance fringe field extent (E_2 * LAM_E).'}
  E3_El: {type: E, unit: "", default: 1.0, doc: 'Sextupolar entrance fringe field extent (E_3 * LAM_E).'}
  E4_El: {type: E, unit: "", default: 1.0, doc: 'Octupolar entrance fringe field extent (E_4 * LAM_E).'}
  E5_El: {type: E, unit: "", default: 1.0, doc: 'Decapolar entrance fringe field extent (E_5 * LAM_E).'}
  E6_El: {type: E, unit: "", default: 1.0, doc: 'Dodecapolar entrance fringe field extent (E_6 * LAM_E).'}
  E7_El: {type: E, unit: "", default: 1.0, doc: '14-polar entrance fringe field extent (E_7 * LAM_E).'}
  E8_El: {type: E, unit: "", default: 1.0, doc: '16-polar entrance fringe field extent (E_8 * LAM_E).'}
  E9_El: {type: E, unit: "", default: 1.0, doc: '18-polar entrance fringe field extent (E_9 * LAM_E).'}
  E10_El: {type: E, unit: "", default: 1.0, doc: '20-polar entrance fringe field extent (E_10 * LAM_E).'}
  NCE_El: {type: I, unit: "", default: 6, doc: 'UNUSED'}
  C0_E_El: {type: E, unit: "", default: 0, doc: "Fringe field coefficient C0"}
  C1_E_El: {type: E, unit: "", default: 1, doc: "Fringe field coefficient C1"}
  C2_E_El: {type: E, unit: "", default: 0, doc: "Fringe field coefficient C2"}
  C3_E_El: {type: E, unit: "", default: 0, doc: "Fringe field coefficient C3"}
  C4_E_El: {type: E, unit: "", default: 0, doc: "Fringe field coefficient C4"}
  C5_E_El: {type: E, unit: "", default: 0, doc: "Fringe field coefficient C5"}
  X_S_El: {type: E, unit: "centimeter", default: 0.0, doc: 'Exit face integration zone for the fringe field'}
  LAM_S_El: {type: E, unit: "centimeter", default: 0.0, doc: 'Exit face fringe field extent'}
  S2_El: {type: E, unit: "", default: 1.0, doc: 'Quadrupole exit fringe field extent (E_2 * LAM_S).'}
  S3_El: {type: E, unit: "", default: 1.0, doc: 'Sextupolar exit fringe field extent (E_3 * LAM_S).'}
  S4_El: {type: E, unit: "", default: 1.0, doc: 'Octupolar exit fringe field extent (E_4 * LAM_S).'}
  S5_El: {type: E, unit: "", default: 1.0, doc: 'Decapolar exit fringe field extent (E_5 * LAM_S).'}
  S6_El: {type: E, unit: "", default: 1.0, doc: 'Dodecapolar exit fringe field extent (E_6 * LAM_S).'}
  S7_El: {type: E, unit: "", default: 1.0, doc: '14-polar exit fringe field extent (E_7 * LAM_S).'}
  S8_El: {type: E, unit: "", default: 1.0, doc: '16-polar exit fringe field extent (E_8 * LAM_S).'}
  S9_El: {type: E, unit: "", default: 1.0, doc: '18-polar exit fringe field extent (E_9 * LAM_S).'}
  S10_El: {type: E, unit: "", default: 1.0, doc: '20-polar exit fringe field extent (E_10 * LAM_S).'}
  NCS_El: {type: I, unit: "", default: 6, doc: 'UNUSED'}
  C0_S_El: {type: E, unit: "", default: 0.0, doc: 'Fringe field coefficient C0'}
  C1_S_El: {type: E, unit: "", default: 1.0, doc: 'Fringe field coefficient C1'}
  C2_S_El: {type: E, unit: "", default: 0.0, doc: 'Fringe field coefficient C2'}
  C3_S_El: {type: E, unit: "", default: 0.0, doc: 'Fringe field coefficient C3'}
  C4_S_El: {type: E, unit: "", default: 0.0, doc: 'Fringe field coefficient C4'}
  C5_S_El: {type: E, unit: "", default: 0.0, doc: 'Fringe field coefficient C5'}
  R1_El: {type: E, unit: "radian", default: 0.0, doc: 'Skew angle of the dipolar elecric field component'}
  R2_El: {type: E, unit: "radian", default: 0.0, doc: 'Skew angle of the quadrupolar elecric field component'}
  R3_El: {type: E, unit: "radian", default: 0.0, doc: 'Skew angle of the sextupolar elecric field component'}
  R4_El: {type: E, unit: "radian", default: 0.0, doc: 'Skew angle of the octupolar elecric field component'}
  R5_El: {type: E, unit: "radian", default: 0.0, doc: 'Skew angle of the decapolar elecric field component'}
  R6_El: {type: E, unit: "radian", default: 0.0, doc: 'Skew angle of the dodecapolar elecric field component'}
  R7_El: {type: E, unit: "radian", default: 0.0, doc: 'Skew angle of the 14-polar elecric field component'}
  R8_El: {type: E, unit: "radian", default: 0.0, doc: 'Skew angle of the 16-polar elecric field component'}
  R9_El: {type: E, unit: "radian", default: 0.0, doc: 'Skew angle of the 18-polar elecric field component'}
  R10_El: {type: E, unit: "radian", default: 0.0, doc: 'Skew angle of the 20-polar elecric field component'}
  # Magnetic poles
  XL: {type: E, unit: "cm", default: 0, doc: "Length of the element"}
  R0: {type: E, unit: "cm", default: 10.0, doc: "Radius at pole tip"}
  B1: {type: E, unit: "kG", default: 0.0, doc: "Field at pole tip for dipolar component."}
  B2: {type: E, unit: "kG", default: 0.0, doc: "Field at pole tip for quadrupolar component."}
  B3: {type: E, unit: "kG", default: 0.0, doc: "Field at pole tip for sextupolar component."}
  B4: {type: E, unit: "kG", default: 0.0, doc: "Field at pole tip for octupolar component."}
  B5: {type: E, unit: "kG", default: 0.0, doc: "Field at pole tip for decapolar component."}
  B6: {type: E, unit: "kG", default: 0.0, doc: "Field at pole tip for dodecapolar component."}
  B7: {type: E, unit: "kG", default: 0.0, doc: "Field at pole tip for 14-polar component."}
  B8: {type: E, unit: "kG", default: 0.0, doc: "Field at pole tip for 16-polar component."}
  B9: {type: E, unit: "kG", default: 0.0, doc: "Field at pole tip for 18-polar component."}
  B10: {type: E, unit: "kG", default: 0.0, doc: "Field at pole tip for 20-polar component."}
  X_E: {type: E, unit: "cm", default: 0.0, doc: "Entrance face integration zone for the fringe field."}
  LAM_E: {type: E, unit: "cm", default: 0.0, doc: "Entrance face dipole fringe field extent"}
  E2: {type: E, unit: "", default: 1.0, doc: "Quadrupole entrance fringe field extent (E_2 * LAM_E)."}
  E3: {type: E, unit: "", default: 1.0, doc: "Sextupolar entrance fringe field extent (E_3 * LAM_E)."}
  E4: {type: E, unit: "", default: 1.0, doc: "Octupolar entrance fringe field extent (E_4 * LAM_E)."}
  E5: {type: E, unit: "", default: 1.0, doc: "Decapolar entrance fringe field extent (E_5 * LAM_E)."}
  E6: {type: E, unit: "", default: 1.0, doc: "Dodecapolar entrance fringe field extent (E_6 * LAM_E)."}
  E7: {type: E, unit: "", default: 1.0, doc: "14-polar entrance fringe field extent (E_7 * LAM_E)."}
  E8: {type: E, unit: "", default: 1.0, doc: "16-polar entrance fringe field extent (E_8 * LAM_E)."}
  E9: {type: E, unit: "", default: 1.0, doc: "18-polar entrance fringe field extent (E_9 * LAM_E)."}
  E10: {type: E, unit: "", default: 1.0, doc: "20-polar entrance fringe field extent (E_10 * LAM_E)."}
  NCE: {type: I, unit: "", default: 6, doc: "UNUSED"}
  C0_E: {type: E, unit: "", default: 0.0, doc: "Fringe field coefficient C0"}
  C1_E: {type: E, unit: "", default: 1.0, doc: "Fringe field coefficient C1"}
  C2_E: {type: E, unit: "", default: 0.0, doc: "Fringe field coefficient C2"}
  C3_E: {type: E, unit: "", default: 0.0, doc: "Fringe field coefficient C3"}
  C4_E: {type: E, unit: "", default: 0.0, doc: "Fringe field coefficient C4"}
  C5_E: {type: E, unit: "", default: 0.0, doc: "Fringe field coefficient C5"}
  X_S: {type: E, unit: "cm", default: 0.0, doc: "Exit face integration zone for the fringe field"}
  LAM_S: {type: E, unit: "cm", default: 0.0, doc: "Exit face fringe field extent"}
  S2: {type: E, unit: "", default: 1.0, doc: "Quadrupole exit fringe field extent (E_2 * LAM_S)."}
  S3: {type: E, unit: "", default: 1.0, doc: "Sextupolar exit fringe field extent (E_3 * LAM_S)."}
  S4: {type: E, unit: "", default: 1.0, doc: "Octupolar exit fringe field extent (E_4 * LAM_S)."}
  S5: {type: E, unit: "", default: 1.0, doc: "Decapolar exit fringe field extent (E_5 * LAM_S)."}
  S6: {type: E, unit: "", default: 1.0, doc: "Dodecapolar exit fringe field extent (E_6 * LAM_S)."}
  S7: {type: E, unit: "", default: 1.0, doc: "14-polar exit fringe field extent (E_7 * LAM_S)."}
  S8: {type: E, unit: "", default: 1.0, doc: "16-polar exit fringe field extent (E_8 * LAM_S)."}
  S9: {type: E, unit: "", default: 1.0, doc: "18-polar exit fringe field extent (E_9 * LAM_S)."}
  S10: {type: E, unit: "", default: 1.0, doc: "20-polar exit fringe field extent (E_10 * LAM_S)."}
  NCS: {type: I, unit: "", default: 6, doc: "UNUSED"}
  C0_S: {type: E, unit: "", default: 0.0, doc: "Fringe field coefficient C0"}
  C1_S: {type: E, unit: "", default: 1.0, doc: "Fringe field coefficient C1"}
  C2_S: {type: E, unit: "", default: 0.0, doc: "Fringe field coefficient C2"}
  C3_S: {type: E, unit: "", default: 0.0, doc: "Fringe field coefficient C3"}
  C4_S: {type: E, unit: "", default: 0.0, doc: "Fringe field coefficient C4"}
  C5_S: {type: E, unit: "", default: 0.0, doc: "Fringe field coefficient C5"}
  R1: {type: E, unit: "radian", default: 0.0, doc: "Skew angle of the dipolar magnetic field component"}
  R2: {type: E, unit: "radian", default: 0.0, doc: "Skew angle of the quadrupolar magnetic field component"}
  R3: {type: E, unit: "radian", default: 0.0, doc: "Skew angle of the sextupolar magnetic field component"}
  R4: {type: E, unit: "radian", default: 0.0, doc: "Skew angle of the octupolar magnetic field component"}
  R5: {type: E, unit: "radian", default: 0.0, doc: "Skew angle of the decapolar magnetic field component"}
  R6: {type: E, unit: "radian", default: 0.0, doc: "Skew angle of the dodecapolar magnetic field component"}
  R7: {type: E, unit: "radian", default: 0.0, doc: "Skew angle of the 14-polar magnetic field component"}
  R8: {type: E, unit: "radian", default: 0.0, doc: "Skew angle of the 16-polar magnetic field component"}
  R9: {type: E, unit: "radian", default: 0.0, doc: "Skew angle of the 18-polar magnetic field component"}
  R10: {type: E, unit: "radian", default: 0.0, doc: "Skew angle of the 20-polar magnetic field component"}
  XPAS: {type: E, unit: "centimeter", default: 1.0, doc: "Integration step"}
  KPOS: {type: I, unit: "", default: 0.0, doc: "Alignment parameter: 1 (element aligned) or 2 (misaligned)"}
  XCE: {type: E, unit: "centimeter", default: 0.0, doc: "X shift"}
  YCE: {type: E, unit: "centimeter", default: 0.0, doc: "Y shift"}
  ALE: {type: E, unit: "radian", default: 0.0, doc: "Tilt"}

template:
- - IL
- - XL_El
  - R0_El
  - PHI1
  - PHI2
  - PHI3
  - PHI4
  - PHI5
  - PHI6
  - PHI7
  - PHI8
  - PHI9
  - PHI10
- - X_E_El
  - LAM_E_El
  - E2_El
  - E3_El
  - E4_El
  - E5_El
  - E6_El
  - E7_El
  - E8_El
  - E9_El
  - E10_El
- - NCE
  - C0_E_El
  - C1_E_El
  - C2_E_El
  - C3_E_El
  - C4_E_El
  - C5_E_El
- - X_S_El
  - LAM_S_El
  - S2_El
  - S3_El
  - S4_El
  - S5_El
  - S6_El
  - S7_El
  - S8_El
  - S9_El
  - S10_El
- - NCS
  - C0_S_El
  - C1_S_El
  - C2_S_El
  - C3_S_El
  - C4_S_El
  - C5_S_El
- - R1_El
  - R2_El
  - R3_El
  - R4_El
  - R5_El
  - R6_El
  - R7_El
  - R8_El
  - R9_El
  - R10_El
- - XL
  - R0
  - B1
  - B2
  - B3
  - B4
  - B5
  - B6
  - B7
  - B8
  - B9
  - B10
- - X_E
  - LAM_E
  - E2
  - E3
  - E4
  - E5
  - E6
  - E7
  - E8
  - E9
  - E10
- - NCE
  - C0_E
  - C1_E
  - C2_E
  - C3_E
  - C4_E
  - C5_E
- - X_S
  - LAM_S
  - S2
  - S3
  - S4
  - S5
  - S6
  - S7
  - S8
  - S9
  - S10
- - NCS
  - C0_S
  - C1_S
  - C2_S
  - C3_S
  - C4_S
  - C5_S
- - R1
  - R2
  - R3
  - R4
  - R5
  - R6
  - R7
  - R8
  - R9
  - R10
- - XPAS
- - KPOS
  - XCE
  - YCE
  - ALE

doc: |
  Electro-magnetic multipole.

  ``EBMULT`` simulates an electro-magnetic multipole, by addition of electric (:math:`\vec{E}`) and
  magnetic (:math:`\vec{B}`) multipole components (dipole to 20-pole). :math:`\vec{E} and its derivatives
  :math:`\frac{∂^{i+j+k} \vec{E}}{∂X^i ∂Y^j ∂Z^k}` (i + j + k ≤ 4) are derived from the general expression of the
  multipole scalar potential (eq. 1.3.5), followed by a :math:`\frac{π}{2n} rotation (n = 1, 2, 3, ...) (see also
  ``ELMULT``). :math:`\vec{B}` and its derivatives are derived from the same general potential, as described in
  section 1.3.7 (see also ``MULTIPOL``).
  ⃗⃗
  The entrance and exit fringe fields of the :math:`\vec{E}` and :math:`\vec{B}` components are treated separately,
  in the same way as described under ``ELMULT`` and ``MULTIPOL``, for each one of these two fields. Wedge angle
  correction is applied in sharp edge field model if :math:`\vec{B_1}` is non zero, as in ``MULTIPOL``. Any of the
  :math:`\vec{E}` or :math:`\vec{B}` multipole field component can be X-rotated independently of the others.

  Use ``PARTICUL`` prior to ``EBMULT``, for the definition of particle mass and charge.
